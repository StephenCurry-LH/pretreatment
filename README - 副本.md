裁剪流程：

第一步：将原始数据进行解帧

`1_seq2img.py`到这个文件里面执行

其中avi_dcm存放着原始数据，有GE和PHILIPS 的，里面存放着患者的avi和dicom数据
直接执行`1_seq2img.py`，就可获得到解帧后的数据，分别存放在dcm_img和avi_img文件夹下。


第二步：进行原始数据的裁剪：（注意：dicom以及avi解析后的分辨率有很多种，针对不同的分辨率尺寸，进行调整）

指定尺寸定为648X480。`look_size.py`查看自己dicom或avi的原始尺寸大小

我是以dicom裁剪到648X480作为目标尺寸，与其相对的avi就要向这个目标尺寸靠拢，使其分辨率相同，投影区域相对应。

（1）开始裁剪，放缩dicom图像：执行`2_1_cut_pad_dcm.py`
    更改路径即可。只是放缩比例针对飞利浦和GE有些不同。
    我的GE中dicom数据有一种尺寸：708*1016
    我的飞利浦中dicom数据有两种格式：768*1024,600*800
    与我的尺寸相同直接使用即可，不同则需要自己重新计算。
    
（2）针对不同尺寸的avi数据进行放缩，裁剪：执行`2_2_cut_pad_avi.py`
    根据不同情况进行选择，一般GE缩放到与目标投影区域重合时，偏大只需裁剪；飞利浦的偏小，除了裁剪还需填充。
    
    我的GE中avi数据有两种尺寸：734X1584，982X1580
    我的飞利浦中avi数据有四种格式：1130X2196,812X1560,820X1560,836X1576
    
    
 注意注意！！！（相同尺寸的，放缩，裁剪，填充，只需要计算一次，但是要保证完全重合）
    
     例如： 
        #GE的avi为982X1580
        #缩放比例：575
        #裁剪比例：[56:536,300:948]，无需填充
        
        #飞利浦_dicom_avi:800X600（需要填充，因为缩放的比例小于目标480，需补充4个像素）
        #缩放比例：476
        #裁剪以及padding比例：(resize_label_img[0:476, 140:788, idx], ((2, 2), (0,0))
  缩放比例计算：

        需要自己进行比对到投影区域重合，算出其像素值是多少：
        比如缩放后的avi的尺寸的高是10.4,则对应像素值就为10.4*(480/8.47)
  裁剪比例计算：
             
        此时就看左上角，相差多少：画一个小矩形，则可知道裁剪的起始点，在分别加上480,648即可
        如：得到小矩形的长是3.2，高是1，则起始点为[3.2*(480/8.47),1*(480/8.47)]=[181,57]
        注意裁剪方法是先是纵坐标，再是横坐标：所以裁剪比例为[57:537,181:1129]
  填充比例计算:
  
       就看放缩后的高和480差几个像素，在参考比对图像进行填充
  裁剪后的图像存放在label下，每个患者有两个文件夹，一个是avi裁剪后的，另一个是dicom裁剪后的
 
 第三步：生成avi和dicom中最相似的匹配度的.txt和json文件：`3_gen_pair.py`文件
        直接执行即可，但针对不同avi和dicom数据，需修改和自己病人名相匹配的。txt文件保存在txt下，json文件保存在json文件夹下
       
         修改这里即可：if 'MLX'in patient or '08-'in patient:
         这是因为我处理的数据，GE中病人名都有’MLX‘,飞利浦病人名都有'08-'
 注意这部分结束之后，需要进行txt文件查看，一般是80%以上算是好的，低于80%的，两个原因：
 
 一种原因是裁剪比例没计算好，需要再进行调整；
 另一种原因是数据本身有问题，需要师兄来协助来查看，将不合格的数据存放在`error_no_use`下。
 
 第四步：根据得到的json文件，得到avi标签最相似的dicom。
    直接执行`4_copy_rename_ori_img.py`即可。得到的最相似的dicom存放在image文件夹下。
   
   
 待处理完所有数据之后，也得到自己数据对应的mask之后需要将目录名称调整为实验室统一组织的形式。
 
 
 
 
 

 
                                                                                
  
                                
  
  

